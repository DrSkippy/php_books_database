<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="table-style.css">
</head>
<body>
<h1>Result</h1>
<table id='mytable' class="styled-table">
    <thead>
    <tr>
        <th>BookCollectionID</th>
        <th>Title</th>
        <th>Author</th>
        <th>CopyrightDate</th>
        <th>Pages</th>
        <th>ReadDate</th>
    </tr>
    </thead>
    <tbody>
    <div>
    </div>
    </tbody>
</table>
<script>
    $(document).ready(function () {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        var url = "http://192.168.127.8/books/books_read";
        if (urlParams.has("year")) {
            $.ajaxSetup({async: false});  // suppress async so the summary row is always at the bottom
            const year = urlParams.get('year');
            url = url + "/" + year
            var url1 = "http://192.168.127.8/books/summary_books_read_by_year/" + year;
        }
        $.getJSON(url, function (data) {
            var obj = data['data'];
            for (var i = 0; i < obj.length; i++) {
                var tr = "<tr>" +
                    "<td>" + obj[i][0] + "</td>" +
                    "<td>" + obj[i][1] + "</td>" +
                    "<td>" + obj[i][2] + "</td>" +
                    "<td>" + obj[i][3] + "</td>" +
                    "<td>" + obj[i][7] + "</td>" +
                    "<td>" + obj[i][13] + "</td></tr>";
                $("#mytable").append(tr);
            }
        });
        if (urlParams.has("year")) {
            $.getJSON(url1, function (data) {
                var obj = data['data'];
                for (var i = 0; i < obj.length; i++) {
                    var tr = "<tr class='summary-row'>" +
                        "<td>" + obj[i][0] + "</td><td></td><td></td><td></td>" +
                        "<td>" + obj[i][1] + "</td>" +
                        "<td>" + obj[i][2] + "</td></tr>";
                    $("#mytable").append(tr);
                }
            });
        }
    });
</script>
</body>
</html>

